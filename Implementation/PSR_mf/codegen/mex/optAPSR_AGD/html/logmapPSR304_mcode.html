<pre class="code">
<span class="srcline"><span class="lineno"><a href="92,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S2T3U3">V</span> = logmapPSR(<span class="var type1" id="S3T3U6">X</span>,<span class="var type1" id="S4T3U7">Y</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="92,2" id="srcline2"> 2</a></span><span class="line"><span class="comment">%#codegen</span></span></span>
<span class="srcline"><span class="lineno"><a href="92,3" id="srcline3"> 3</a></span><span class="line"><span class="comment">% compute the log map on the product space of spheres log_X(Y)</span></span></span>
<span class="srcline"><span class="lineno"><a href="92,4" id="srcline4"> 4</a></span><span class="line"><span class="comment">% Input:</span></span></span>
<span class="srcline"><span class="lineno"><a href="92,5" id="srcline5"> 5</a></span><span class="line"><span class="comment">%     X, Y - d-by-N matrices, points in the product space</span></span></span>
<span class="srcline"><span class="lineno"><a href="92,6" id="srcline6"> 6</a></span><span class="line"><span class="comment">% Output:</span></span></span>
<span class="srcline"><span class="lineno"><a href="92,7" id="srcline7"> 7</a></span><span class="line"><span class="comment">%     V - logmap (d-by-N matrix)</span></span></span>
<span class="srcline"><span class="lineno"><a href="92,8" id="srcline8"> 8</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="92,9" id="srcline9"> 9</a></span><span class="line"><span class="mxinfo " id="T3:U4"><span class="var type1" id="S2T3U10">V</span> = <span class="mxinfo " id="T3:U6">zeros(<span class="mxinfo " id="T47:U7">size(<span class="var type1" id="S3T3U15">X</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="92,10" id="srcline10">10</a></span><span class="line"><span class="comment">% do logmap for each column of X and Y, which are d-by-1 vectors</span></span></span>
<span class="srcline"><span class="lineno"><a href="92,11" id="srcline11">11</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S7T2U18">i</span> = <span class="mxinfo " id="T2:U10">1</span>:<span class="mxinfo " id="T2:U11">size(<span class="var type1" id="S3T3U23">X</span>,2)</span></span></span>
<span class="srcline"><span class="lineno"><a href="92,12" id="srcline12">12</a></span><span class="line">    <span class="mxinfo " id="T18:U13"><span class="var type1" id="S8T18U27">x</span> = <span class="mxinfo " id="T18:U15">squeeze(<span class="mxinfo " id="T18:U16"><span class="var type1" id="S3T3U31">X</span>(:,<span class="var type1" id="S7T2U33">i</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="92,13" id="srcline13">13</a></span><span class="line">    <span class="mxinfo " id="T18:U19"><span class="var type1" id="S10T18U36">y</span> = <span class="mxinfo " id="T18:U21">squeeze(<span class="mxinfo " id="T18:U22"><span class="var type1" id="S4T3U40">Y</span>(:,<span class="var type1" id="S7T2U42">i</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="92,14" id="srcline14">14</a></span><span class="line">    <span class="comment">% logmap of SR</span></span></span>
<span class="srcline"><span class="lineno"><a href="92,15" id="srcline15">15</a></span><span class="line">    <span class="mxinfo " id="T2:U25"><span class="var type1" id="S11T2U45">temp</span> = <span class="mxinfo " id="T2:U27"><span class="mxinfo " id="T19:U28"><span class="var type1" id="S8T18U48">x</span>'</span>*<span class="var type1" id="S10T18U49">y</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="92,16" id="srcline16">16</a></span><span class="line">    <span class="mxinfo " id="T18:U31"><span class="var type1" id="S12T18U52">u</span> = <span class="mxinfo " id="T18:U33"><span class="var type1" id="S10T18U54">y</span> - <span class="mxinfo " id="T18:U35"><span class="var type1" id="S11T2U56">temp</span>*<span class="var type1" id="S8T18U57">x</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="92,17" id="srcline17">17</a></span><span class="line">    <span class="mxinfo " id="T2:U38"><span class="var type1" id="S13T2U60">normu</span> = <span class="mxinfo " id="T2:U40">norm(<span class="var type1" id="S12T18U63">u</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="92,18" id="srcline18">18</a></span><span class="line">    <span class="keyword">if</span> (<span class="mxinfo " id="T5:U42"><span class="var type1" id="S13T2U68">normu</span> == <span class="mxinfo " id="T2:U44">0</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="92,19" id="srcline19">19</a></span><span class="line">        <span class="mxinfo " id="T18:U45"><span class="var type1" id="S15T18U72">v</span> = <span class="var type1" id="S12T18U73">u</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="92,20" id="srcline20">20</a></span><span class="line">    <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="92,21" id="srcline21">21</a></span><span class="line">        <span class="mxinfo " id="T18:U48"><span class="var type1" id="S12T18U77">u</span> = <span class="mxinfo " id="T18:U50"><span class="var type1" id="S12T18U79">u</span>/<span class="mxinfo " id="T2:U52">norm(<span class="var type1" id="S12T18U82">u</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="92,22" id="srcline22">22</a></span><span class="line">        <span class="keyword">if</span> <span class="mxinfo " id="T5:U54"><span class="var type1" id="S11T2U86">temp</span>&gt;<span class="mxinfo " id="T2:U56">1</span></span> <span class="mxinfo " id="T2:U57"><span class="var type1" id="S11T2U90">temp</span> = <span class="mxinfo " id="T2:U59">1</span></span>; <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="92,23" id="srcline23">23</a></span><span class="line">        <span class="keyword">if</span> <span class="mxinfo " id="T5:U60"><span class="var type1" id="S11T2U95">temp</span>&lt;<span class="mxinfo " id="T2:U62">-<span class="mxinfo " id="T2:U63">1</span></span></span> <span class="mxinfo " id="T2:U64"><span class="var type1" id="S11T2U100">temp</span> = <span class="mxinfo " id="T2:U66">-<span class="mxinfo " id="T2:U67">1</span></span></span>; <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="92,24" id="srcline24">24</a></span><span class="line">        <span class="mxinfo " id="T18:U68"><span class="var type1" id="S15T18U105">v</span> = <span class="mxinfo " id="T18:U70"><span class="mxinfo " id="T2:U71">acos(<span class="var type1" id="S11T2U109">temp</span>)</span>*<span class="var type1" id="S12T18U110">u</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="92,25" id="srcline25">25</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="92,26" id="srcline26">26</a></span><span class="line">    <span class="mxinfo " id="T18:U74"><span class="mxinfo " id="T18:U75"><span class="var type1" id="S2T3U114">V</span>(:,<span class="var type1" id="S7T2U116">i</span>)</span> = <span class="var type1" id="S15T18U117">v</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="92,27" id="srcline27">27</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="92,28" id="srcline28">28</a></span><span class="line"><span class="keyword"><span class="keyword">end</span></span></span></span>
</pre>
